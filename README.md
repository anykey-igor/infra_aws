# infra

>![Infra Diagram_DEV](img/simple_diagram.png)

s3 bucket for dev and production environment
dynamodb table for dev and production environment

For DEV Environment:
- app-team1-tf-remote-state-lock-dev
- app-team1-s3-remote-state-dev

```
backend "s3" {
  # The name of the bucket, which was defined in "aws_s3_bucket"
        bucket         = "app-team1-s3-rstate-dev-tf"
        key            = "infra/dev/terraform.tfstate"
        region         = "eu-central-1"
        # Table name in DynamoDB, which was defined in "aws_dynamodb_table"
        dynamodb_table = "app-team1-dynamodb-lock-tf"
        encrypt        = true
}
```
For PROD Env:
- app-team1-tf-remote-state-lock-prod
- app-team1-s3-remote-state-prod


## Requirements
| Name | Version |
|------|---------|
| <a name="requirement_aws"></a> [aws](#requirement\_aws) | ~> 4.0 |

## Modules

| Name                                                                               | Source | Version |
|------------------------------------------------------------------------------------|--------|---------|
| <a name="module_acm_backend"></a> [acm\_backend](modulescm/README.md)          | ./modules/acm | n/a |
| <a name="module_acm_frontend"></a> [acm\_frontend](modulescm/README.md)        | ./modules/acm | n/a |
| <a name="module_alb"></a> [alb](moduleslb/README.md)                           | ./modules/alb | n/a |
| <a name="module_aurora_mysql_v2"></a> [aurora\_mysql\_v2](modulesds/README.md) | ./modules/rds/ | n/a |
| <a name="module_ecr_backend"></a> [ecr\_backend](modulescr/README.md)          | ./modules/ecr/ | n/a |
| <a name="module_ecr_frontend"></a> [ecr\_frontend](modulescr/README.md)        | ./modules/ecr/ | n/a |
| <a name="module_ecs"></a> [ecs](modulescs/README.md)                           | ./modules/ecs | n/a |
| <a name="module_frontend"></a> [frontend](modulesloudfront/README.md)          | ./modules/cloudfront | n/a |
| <a name="module_r53"></a> [r53](modules53/README.md)                           | ./modules/r53 | n/a |
| <a name="module_r53_frontend"></a> [r53\_frontend](modules53/README.md)        | ./modules/r53 | n/a |
| <a name="module_sg_backend"></a> [sg\_backend](modulesg/README.md)             | ./modules/sg | n/a |
| <a name="module_vpc"></a> [vpc](modulespc/README.md)                           | ./modules/vpc/ | n/a |

## Inputs

| Name | Description | Type | Default | Required |
|------|-------------|------|---------|:--------:|
| <a name="input_backend_url"></a> [backend\_url](#input\_backend\_url) | Back-End URL | `string` | n/a | yes |
| <a name="input_contact_email"></a> [contact\_email](#input\_contact\_email) | Contact Email | `string` | `"contact_email"` | no |
| <a name="input_createdby"></a> [createdby](#input\_createdby) | Created by | `string` | `"Anikeiev Ihor"` | no |
| <a name="input_domain_name"></a> [domain\_name](#input\_domain\_name) | Hosted Zone | `string` | n/a | yes |
| <a name="input_ecr_lifecycle_policy"></a> [ecr\_lifecycle\_policy](#input\_ecr\_lifecycle\_policy) | Json file with lifecycle policy | `string` | `""` | no |
| <a name="input_ecr_repo_policy_template"></a> [ecr\_repo\_policy\_template](#input\_ecr\_repo\_policy\_template) | Json file with policy | `string` | `""` | no |
| <a name="input_enable_ecr_lifecycle_policy"></a> [enable\_ecr\_lifecycle\_policy](#input\_enable\_ecr\_lifecycle\_policy) | Enable ecr lifecycle policy | `bool` | `false` | no |
| <a name="input_enable_ecr_repo_policy"></a> [enable\_ecr\_repo\_policy](#input\_enable\_ecr\_repo\_policy) | Enable ecr repo policy usage | `bool` | `false` | no |
| <a name="input_environment"></a> [environment](#input\_environment) | Environment for service | `string` | `"test"` | no |
| <a name="input_frontend_url"></a> [frontend\_url](#input\_frontend\_url) | Front-end URL | `string` | n/a | yes |
| <a name="input_orchestration"></a> [orchestration](#input\_orchestration) | Type of Orchestration | `string` | `"tf"` | no |
| <a name="input_private_subnet_cidr"></a> [private\_subnet\_cidr](#input\_private\_subnet\_cidr) | CIDR list for Private Subnets | `list(string)` | `[]` | no |
| <a name="input_project"></a> [project](#input\_project) | Name of Project | `string` | `"test"` | no |
| <a name="input_public_subnet_cidr"></a> [public\_subnet\_cidr](#input\_public\_subnet\_cidr) | CIDR list for Public Subnets | `list(string)` | `[]` | no |
| <a name="input_region"></a> [region](#input\_region) | The region where to deploy this code (e.g. us-east-1). | `string` | `"eu-central-1"` | no |
| <a name="input_team"></a> [team](#input\_team) | Team | `string` | `"number_of_team"` | no |
| <a name="input_vpc_cidr"></a> [vpc\_cidr](#input\_vpc\_cidr) | CIDR for the whole VPC | `string` | n/a | yes |

## Outputs

| Name | Description                                                                                                                                                                                                                                                                                                                                            |
|------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| <a name="output_acm_certificate_arn_backend"></a> [acm\_certificate\_arn\_backend](#output\_acm\_certificate\_arn\_backend) | The ARN of the certificate                                                                                                                                                                                                                                                                                                                             |
| <a name="output_acm_certificate_arn_frontend"></a> [acm\_certificate\_arn\_frontend](#output\_acm\_certificate\_arn\_frontend) | The ARN of the certificate                                                                                                                                                                                                                                                                                                                             |
| <a name="output_acm_certificate_domain_validation_options_backend"></a> [acm\_certificate\_domain\_validation\_options\_backend](#output\_acm\_certificate\_domain\_validation\_options\_backend) | A list of attributes to feed into other resources to complete certificate validation. Can have more than one element, e.g. if SANs are defined. Only set if DNS-validation was used.                                                                                                                                                                   |
| <a name="output_acm_certificate_domain_validation_options_frontend"></a> [acm\_certificate\_domain\_validation\_options\_frontend](#output\_acm\_certificate\_domain\_validation\_options\_frontend) | A list of attributes to feed into other resources to complete certificate validation. Can have more than one element, e.g. if SANs are defined. Only set if DNS-validation was used.                                                                                                                                                                   |
| <a name="output_acm_certificate_status_backend"></a> [acm\_certificate\_status\_backend](#output\_acm\_certificate\_status\_backend) | Status of the certificate.                                                                                                                                                                                                                                                                                                                             |
| <a name="output_acm_certificate_status_frontend"></a> [acm\_certificate\_status\_frontend](#output\_acm\_certificate\_status\_frontend) | Status of the certificate.                                                                                                                                                                                                                                                                                                                             |
| <a name="output_aws_ecr_backend_repository_arn"></a> [aws\_ecr\_backend\_repository\_arn](#output\_aws\_ecr\_backend\_repository\_arn) | Full ARN of the repository.                                                                                                                                                                                                                                                                                                                            |
| <a name="output_aws_ecr_backend_repository_name"></a> [aws\_ecr\_backend\_repository\_name](#output\_aws\_ecr\_backend\_repository\_name) | The name of the repository.                                                                                                                                                                                                                                                                                                                            |
| <a name="output_aws_ecr_backend_repository_registry_id"></a> [aws\_ecr\_backend\_repository\_registry\_id](#output\_aws\_ecr\_backend\_repository\_registry\_id) | The registry ID where the repository was created.                                                                                                                                                                                                                                                                                                      |
| <a name="output_aws_ecr_backend_repository_url"></a> [aws\_ecr\_backend\_repository\_url](#output\_aws\_ecr\_backend\_repository\_url) | The URL of the repository (in the form aws\_account\_id.dkr.ecr.region.amazonaws.com/repositoryName                                                                                                                                                                                                                                                    |
| <a name="output_aws_ecr_frontend_repository_arn"></a> [aws\_ecr\_frontend\_repository\_arn](#output\_aws\_ecr\_frontend\_repository\_arn) | Full ARN of the repository.                                                                                                                                                                                                                                                                                                                            |
| <a name="output_aws_ecr_frontend_repository_name"></a> [aws\_ecr\_frontend\_repository\_name](#output\_aws\_ecr\_frontend\_repository\_name) | The name of the repository.                                                                                                                                                                                                                                                                                                                            |
| <a name="output_aws_ecr_frontend_repository_registry_id"></a> [aws\_ecr\_frontend\_repository\_registry\_id](#output\_aws\_ecr\_frontend\_repository\_registry\_id) | The registry ID where the repository was created.                                                                                                                                                                                                                                                                                                      |
| <a name="output_aws_ecr_frontend_repository_url"></a> [aws\_ecr\_frontend\_repository\_url](#output\_aws\_ecr\_frontend\_repository\_url) | The URL of the repository (in the form aws\_account\_id.dkr.ecr.region.amazonaws.com/repositoryName                                                                                                                                                                                                                                                    |
| <a name="output_cloudfront_dist_domain_name"></a> [cloudfront\_dist\_domain\_name](#output\_cloudfront\_dist\_domain\_name) | n/a                                                                                                                                                                                                                                                                                                                                                    |
| <a name="output_cloudfront_dist_hosted_zone_id"></a> [cloudfront\_dist\_hosted\_zone\_id](#output\_cloudfront\_dist\_hosted\_zone\_id) | n/a                                                                                                                                                                                                                                                                                                                                                    |
| <a name="output_database_group_name"></a> [database\_group\_name](#output\_database\_group\_name) | n/a                                                                                                                                                                                                                                                                                                                                                    |
| <a name="output_dist_arn"></a> [dist\_arn](#output\_dist\_arn) | n/a                                                                                                                                                                                                                                                                                                                                                    |
| <a name="output_domain_arn"></a> [domain\_arn](#output\_domain\_arn) | n/a                                                                                                                                                                                                                                                                                                                                                    |
| <a name="output_domain_id"></a> [domain\_id](#output\_domain\_id) | n/a                                                                                                                                                                                                                                                                                                                                                    |
| <a name="output_domain_name"></a> [domain\_name](#output\_domain\_name) | n/a                                                                                                                                                                                                                                                                                                                                                    |
| <a name="output_domain_summary"></a> [domain\_summary](#output\_domain\_summary) | n/a                                                                                                                                                                                                                                                                                                                                                    |
| <a name="output_domain_zone_id"></a> [domain\_zone\_id](#output\_domain\_zone\_id) | n/a                                                                                                                                                                                                                                                                                                                                                    |
| <a name="output_igw_arn"></a> [igw\_arn](#output\_igw\_arn) | The ARN of the Internet Gateway                                                                                                                                                                                                                                                                                                                        |
| <a name="output_igw_id"></a> [igw\_id](#output\_igw\_id) | The ID of the Internet Gateway                                                                                                                                                                                                                                                                                                                         |
| <a name="output_instance_tenancy"></a> [instance\_tenancy](#output\_instance\_tenancy) | Tenancy of instances spin up within VPC                                                                                                                                                                                                                                                                                                                |
| <a name="output_nat_gw_ids"></a> [nat\_gw\_ids](#output\_nat\_gw\_ids) | List of NAT Gateway IDs                                                                                                                                                                                                                                                                                                                                |
| <a name="output_nat_ids"></a> [nat\_ids](#output\_nat\_ids) | List of allocation ID of Elastic IPs created for AWS NAT Gateway                                                                                                                                                                                                                                                                                       |
| <a name="output_oai_arn"></a> [oai\_arn](#output\_oai\_arn) | n/a                                                                                                                                                                                                                                                                                                                                                    |
| <a name="output_private_nat_gateway_route_ids"></a> [private\_nat\_gateway\_route\_ids](#output\_private\_nat\_gateway\_route\_ids) | List of IDs of the private nat gateway route                                                                                                                                                                                                                                                                                                           |
| <a name="output_private_route_table_association_ids"></a> [private\_route\_table\_association\_ids](#output\_private\_route\_table\_association\_ids) | List of IDs of the private route table association                                                                                                                                                                                                                                                                                                     |
| <a name="output_private_route_table_ids"></a> [private\_route\_table\_ids](#output\_private\_route\_table\_ids) | List of IDs of private route tables                                                                                                                                                                                                                                                                                                                    |
| <a name="output_private_subnet_arns"></a> [private\_subnet\_arns](#output\_private\_subnet\_arns) | List of ARNs of private subnets                                                                                                                                                                                                                                                                                                                        |
| <a name="output_private_subnets"></a> [private\_subnets](#output\_private\_subnets) | List of IDs of private subnets                                                                                                                                                                                                                                                                                                                         |
| <a name="output_private_subnets_cidr_blocks"></a> [private\_subnets\_cidr\_blocks](#output\_private\_subnets\_cidr\_blocks) | List of cidr\_blocks of private subnets                                                                                                                                                                                                                                                                                                                |
| <a name="output_public_internet_gateway_route_id"></a> [public\_internet\_gateway\_route\_id](#output\_public\_internet\_gateway\_route\_id) | ID of the internet gateway route                                                                                                                                                                                                                                                                                                                       |
| <a name="output_public_route_table_association_ids"></a> [public\_route\_table\_association\_ids](#output\_public\_route\_table\_association\_ids) | List of IDs of the public route table association                                                                                                                                                                                                                                                                                                      |
| <a name="output_public_route_table_ids"></a> [public\_route\_table\_ids](#output\_public\_route\_table\_ids) | List of IDs of public route tables                                                                                                                                                                                                                                                                                                                     |
| <a name="output_public_subnet_arns"></a> [public\_subnet\_arns](#output\_public\_subnet\_arns) | List of ARNs of public subnets                                                                                                                                                                                                                                                                                                                         |
| <a name="output_public_subnets"></a> [public\_subnets](#output\_public\_subnets) | List of IDs of public subnets                                                                                                                                                                                                                                                                                                                          |
| <a name="output_public_subnets_cidr_blocks"></a> [public\_subnets\_cidr\_blocks](#output\_public\_subnets\_cidr\_blocks) | List of cidr\_blocks of public subnets                                                                                                                                                                                                                                                                                                                 |
| <a name="output_sg_alb_http_pl_asia_id"></a> [sg\_alb\_http\_pl\_asia\_id](#output\_sg\_alb\_http\_pl\_asia\_id) | n/a                                                                                                                                                                                                                                                                                                                                                    |
| <a name="output_sg_alb_http_pl_easteu_id"></a> [sg\_alb\_http\_pl\_easteu\_id](#output\_sg\_alb\_http\_pl\_easteu\_id) | output "aws\_alb\_target\_group\_arn" { value = module.alb.aws\_alb\_target\_group\_arn } ---------------------------------------------------------------------------------------------------------------------# Security Group ---------------------------------------------------------------------------------------------------------------------# |
| <a name="output_sg_alb_https_pl_asia_id"></a> [sg\_alb\_https\_pl\_asia\_id](#output\_sg\_alb\_https\_pl\_asia\_id) | n/a                                                                                                                                                                                                                                                                                                                                                    |
| <a name="output_sg_alb_https_pl_easteu_id"></a> [sg\_alb\_https\_pl\_easteu\_id](#output\_sg\_alb\_https\_pl\_easteu\_id) | n/a                                                                                                                                                                                                                                                                                                                                                    |
| <a name="output_sg_database_ecs_id"></a> [sg\_database\_ecs\_id](#output\_sg\_database\_ecs\_id) | n/a                                                                                                                                                                                                                                                                                                                                                    |
| <a name="output_sg_ecs_service"></a> [sg\_ecs\_service](#output\_sg\_ecs\_service) | n/a                                                                                                                                                                                                                                                                                                                                                    |
| <a name="output_vpc_arn"></a> [vpc\_arn](#output\_vpc\_arn) | The ARN of the VPC                                                                                                                                                                                                                                                                                                                                     |
| <a name="output_vpc_cidr_block"></a> [vpc\_cidr\_block](#output\_vpc\_cidr\_block) | The CIDR block of the VPC                                                                                                                                                                                                                                                                                                                              |
| <a name="output_vpc_enable_dns_hostnames"></a> [vpc\_enable\_dns\_hostnames](#output\_vpc\_enable\_dns\_hostnames) | Whether or not the VPC has DNS hostname support                                                                                                                                                                                                                                                                                                        |
| <a name="output_vpc_enable_dns_support"></a> [vpc\_enable\_dns\_support](#output\_vpc\_enable\_dns\_support) | Whether or not the VPC has DNS support                                                                                                                                                                                                                                                                                                                 |
| <a name="output_vpc_id"></a> [vpc\_id](#output\_vpc\_id) | The ID of the VPC                                                                                                                                                                                                                                                                                                                                      |
| <a name="output_vpc_main_route_table_id"></a> [vpc\_main\_route\_table\_id](#output\_vpc\_main\_route\_table\_id) | The ID of the main route table associated with this VPC                                                                                                                                                                                                                                                                                                |
| <a name="output_vpc_owner_id"></a> [vpc\_owner\_id](#output\_vpc\_owner\_id) | The ID of the AWS account that owns the VPC                                                                                                                                                                                                                                                                                                            |
